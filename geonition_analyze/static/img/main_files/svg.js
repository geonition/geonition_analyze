/*
	Copyright (c) 2004-2010, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


window[esri._dojoScopeName||"dojo"]._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","dojox.gfx.svg"],["require","dojox.gfx._base"],["require","dojox.gfx.shape"],["require","dojox.gfx.path"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["dojox.gfx.svg"]){_4._hasResource["dojox.gfx.svg"]=true;_4.provide("dojox.gfx.svg");_4.require("dojox.gfx._base");_4.require("dojox.gfx.shape");_4.require("dojox.gfx.path");(function(){var d=_4,g=_6.gfx,gs=g.shape,_7=g.svg;_7.useSvgWeb=(typeof (window.svgweb)!=="undefined");var _8=function(ns,_9){if(_4.doc.createElementNS){return _4.doc.createElementNS(ns,_9);}else{return _4.doc.createElement(_9);}};var _a=function(_b){if(_7.useSvgWeb){return _4.doc.createTextNode(_b,true);}else{return _4.doc.createTextNode(_b);}};var _c=function(){if(_7.useSvgWeb){return _4.doc.createDocumentFragment(true);}else{return _4.doc.createDocumentFragment();}};_7.xmlns={xlink:"http://www.w3.org/1999/xlink",svg:"http://www.w3.org/2000/svg"};_7.getRef=function(_d){if(!_d||_d=="none"){return null;}if(_d.match(/^url\(#.+\)$/)){return d.byId(_d.slice(5,-1));}if(_d.match(/^#dojoUnique\d+$/)){return d.byId(_d.slice(1));}return null;};_7.dasharray={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]};d.extend(g.Shape,{setFill:function(_e){if(!_e){this.fillStyle=null;this.rawNode.setAttribute("fill","none");this.rawNode.setAttribute("fill-opacity",0);return this;}var f;var _f=function(x){this.setAttribute(x,f[x].toFixed(8));};if(typeof (_e)=="object"&&"type" in _e){switch(_e.type){case "linear":f=g.makeParameters(g.defaultLinearGradient,_e);var _10=this._setFillObject(f,"linearGradient");d.forEach(["x1","y1","x2","y2"],_f,_10);break;case "radial":f=g.makeParameters(g.defaultRadialGradient,_e);var _10=this._setFillObject(f,"radialGradient");d.forEach(["cx","cy","r"],_f,_10);break;case "pattern":f=g.makeParameters(g.defaultPattern,_e);var _11=this._setFillObject(f,"pattern");d.forEach(["x","y","width","height"],_f,_11);break;}this.fillStyle=f;return this;}var f=g.normalizeColor(_e);this.fillStyle=f;this.rawNode.setAttribute("fill",f.toCss());this.rawNode.setAttribute("fill-opacity",f.a);this.rawNode.setAttribute("fill-rule","evenodd");return this;},setStroke:function(_12){var rn=this.rawNode;if(!_12){this.strokeStyle=null;rn.setAttribute("stroke","none");rn.setAttribute("stroke-opacity",0);return this;}if(typeof _12=="string"||d.isArray(_12)||_12 instanceof d.Color){_12={color:_12};}var s=this.strokeStyle=g.makeParameters(g.defaultStroke,_12);s.color=g.normalizeColor(s.color);if(s){rn.setAttribute("stroke",s.color.toCss());rn.setAttribute("stroke-opacity",s.color.a);rn.setAttribute("stroke-width",s.width);rn.setAttribute("stroke-linecap",s.cap);if(typeof s.join=="number"){rn.setAttribute("stroke-linejoin","miter");rn.setAttribute("stroke-miterlimit",s.join);}else{rn.setAttribute("stroke-linejoin",s.join);}var da=s.style.toLowerCase();if(da in _7.dasharray){da=_7.dasharray[da];}if(da instanceof Array){da=d._toArray(da);for(var i=0;i<da.length;++i){da[i]*=s.width;}if(s.cap!="butt"){for(var i=0;i<da.length;i+=2){da[i]-=s.width;if(da[i]<1){da[i]=1;}}for(var i=1;i<da.length;i+=2){da[i]+=s.width;}}da=da.join(",");}rn.setAttribute("stroke-dasharray",da);rn.setAttribute("dojoGfxStrokeStyle",s.style);}return this;},_getParentSurface:function(){var _13=this.parent;for(;_13&&!(_13 instanceof g.Surface);_13=_13.parent){}return _13;},_setFillObject:function(f,_14){var _15=_7.xmlns.svg;this.fillStyle=f;var _16=this._getParentSurface(),_17=_16.defNode,_18=this.rawNode.getAttribute("fill"),ref=_7.getRef(_18);if(ref){_18=ref;if(_18.tagName.toLowerCase()!=_14.toLowerCase()){var id=_18.id;_18.parentNode.removeChild(_18);_18=_8(_15,_14);_18.setAttribute("id",id);_17.appendChild(_18);}else{while(_18.childNodes.length){_18.removeChild(_18.lastChild);}}}else{_18=_8(_15,_14);_18.setAttribute("id",g._base._getUniqueId());_17.appendChild(_18);}if(_14=="pattern"){_18.setAttribute("patternUnits","userSpaceOnUse");var img=_8(_15,"image");img.setAttribute("x",0);img.setAttribute("y",0);img.setAttribute("width",f.width.toFixed(8));img.setAttribute("height",f.height.toFixed(8));img.setAttributeNS(_7.xmlns.xlink,"xlink:href",f.src);_18.appendChild(img);}else{_18.setAttribute("gradientUnits","userSpaceOnUse");for(var i=0;i<f.colors.length;++i){var c=f.colors[i],t=_8(_15,"stop"),cc=c.color=g.normalizeColor(c.color);t.setAttribute("offset",c.offset.toFixed(8));t.setAttribute("stop-color",cc.toCss());t.setAttribute("stop-opacity",cc.a);_18.appendChild(t);}}this.rawNode.setAttribute("fill","url(#"+_18.getAttribute("id")+")");this.rawNode.removeAttribute("fill-opacity");this.rawNode.setAttribute("fill-rule","evenodd");return _18;},_applyTransform:function(){var _19=this.matrix;if(_19){var tm=this.matrix;this.rawNode.setAttribute("transform","matrix("+tm.xx.toFixed(8)+","+tm.yx.toFixed(8)+","+tm.xy.toFixed(8)+","+tm.yy.toFixed(8)+","+tm.dx.toFixed(8)+","+tm.dy.toFixed(8)+")");}else{this.rawNode.removeAttribute("transform");}return this;},setRawNode:function(_1a){var r=this.rawNode=_1a;if(this.shape.type!="image"){r.setAttribute("fill","none");}r.setAttribute("fill-opacity",0);r.setAttribute("stroke","none");r.setAttribute("stroke-opacity",0);r.setAttribute("stroke-width",1);r.setAttribute("stroke-linecap","butt");r.setAttribute("stroke-linejoin","miter");r.setAttribute("stroke-miterlimit",4);},setShape:function(_1b){this.shape=g.makeParameters(this.shape,_1b);for(var i in this.shape){if(i!="type"){this.rawNode.setAttribute(i,this.shape[i]);}}this.bbox=null;return this;},_moveToFront:function(){this.rawNode.parentNode.appendChild(this.rawNode);return this;},_moveToBack:function(){this.rawNode.parentNode.insertBefore(this.rawNode,this.rawNode.parentNode.firstChild);return this;}});_4.declare("dojox.gfx.Group",g.Shape,{constructor:function(){_7.Container._init.call(this);},setRawNode:function(_1c){this.rawNode=_1c;}});g.Group.nodeType="g";_4.declare("dojox.gfx.Rect",gs.Rect,{setShape:function(_1d){this.shape=g.makeParameters(this.shape,_1d);this.bbox=null;for(var i in this.shape){if(i!="type"&&i!="r"){this.rawNode.setAttribute(i,this.shape[i]);}}if(this.shape.r){this.rawNode.setAttribute("ry",this.shape.r);this.rawNode.setAttribute("rx",this.shape.r);}return this;}});g.Rect.nodeType="rect";g.Ellipse=gs.Ellipse;g.Ellipse.nodeType="ellipse";g.Circle=gs.Circle;g.Circle.nodeType="circle";g.Line=gs.Line;g.Line.nodeType="line";_4.declare("dojox.gfx.Polyline",gs.Polyline,{setShape:function(_1e,_1f){if(_1e&&_1e instanceof Array){this.shape=g.makeParameters(this.shape,{points:_1e});if(_1f&&this.shape.points.length){this.shape.points.push(this.shape.points[0]);}}else{this.shape=g.makeParameters(this.shape,_1e);}this.bbox=null;this._normalizePoints();var _20=[],p=this.shape.points;for(var i=0;i<p.length;++i){_20.push(p[i].x.toFixed(8),p[i].y.toFixed(8));}this.rawNode.setAttribute("points",_20.join(" "));return this;}});g.Polyline.nodeType="polyline";_4.declare("dojox.gfx.Image",gs.Image,{setShape:function(_21){this.shape=g.makeParameters(this.shape,_21);this.bbox=null;var _22=this.rawNode;for(var i in this.shape){if(i!="type"&&i!="src"){_22.setAttribute(i,this.shape[i]);}}_22.setAttribute("preserveAspectRatio","none");_22.setAttributeNS(_7.xmlns.xlink,"xlink:href",this.shape.src);return this;}});g.Image.nodeType="image";_4.declare("dojox.gfx.Text",gs.Text,{setShape:function(_23){this.shape=g.makeParameters(this.shape,_23);this.bbox=null;var r=this.rawNode,s=this.shape;r.setAttribute("x",s.x);r.setAttribute("y",s.y);r.setAttribute("text-anchor",s.align);r.setAttribute("text-decoration",s.decoration);r.setAttribute("rotate",s.rotated?90:0);r.setAttribute("kerning",s.kerning?"auto":0);r.setAttribute("text-rendering","optimizeLegibility");if(r.firstChild){r.firstChild.nodeValue=s.text;}else{r.appendChild(_a(s.text));}return this;},getTextWidth:function(){var _24=this.rawNode,_25=_24.parentNode,_26=_24.cloneNode(true);_26.style.visibility="hidden";var _27=0,_28=_26.firstChild.nodeValue;_25.appendChild(_26);if(_28!=""){while(!_27){if(_26.getBBox){_27=parseInt(_26.getBBox().width);}else{_27=68;}}}_25.removeChild(_26);return _27;}});g.Text.nodeType="text";_4.declare("dojox.gfx.Path",g.path.Path,{_updateWithSegment:function(_29){g.Path.superclass._updateWithSegment.apply(this,arguments);if(typeof (this.shape.path)=="string"){this.rawNode.setAttribute("d",this.shape.path);}},setShape:function(_2a){g.Path.superclass.setShape.apply(this,arguments);this.rawNode.setAttribute("d",this.shape.path);return this;}});g.Path.nodeType="path";_4.declare("dojox.gfx.TextPath",g.path.TextPath,{_updateWithSegment:function(_2b){g.Path.superclass._updateWithSegment.apply(this,arguments);this._setTextPath();},setShape:function(_2c){g.Path.superclass.setShape.apply(this,arguments);this._setTextPath();return this;},_setTextPath:function(){if(typeof this.shape.path!="string"){return;}var r=this.rawNode;if(!r.firstChild){var tp=_8(_7.xmlns.svg,"textPath"),tx=_a("");tp.appendChild(tx);r.appendChild(tp);}var ref=r.firstChild.getAttributeNS(_7.xmlns.xlink,"href"),_2d=ref&&_7.getRef(ref);if(!_2d){var _2e=this._getParentSurface();if(_2e){var _2f=_2e.defNode;_2d=_8(_7.xmlns.svg,"path");var id=g._base._getUniqueId();_2d.setAttribute("id",id);_2f.appendChild(_2d);r.firstChild.setAttributeNS(_7.xmlns.xlink,"xlink:href","#"+id);}}if(_2d){_2d.setAttribute("d",this.shape.path);}},_setText:function(){var r=this.rawNode;if(!r.firstChild){var tp=_8(_7.xmlns.svg,"textPath"),tx=_a("");tp.appendChild(tx);r.appendChild(tp);}r=r.firstChild;var t=this.text;r.setAttribute("alignment-baseline","middle");switch(t.align){case "middle":r.setAttribute("text-anchor","middle");r.setAttribute("startOffset","50%");break;case "end":r.setAttribute("text-anchor","end");r.setAttribute("startOffset","100%");break;default:r.setAttribute("text-anchor","start");r.setAttribute("startOffset","0%");break;}r.setAttribute("baseline-shift","0.5ex");r.setAttribute("text-decoration",t.decoration);r.setAttribute("rotate",t.rotated?90:0);r.setAttribute("kerning",t.kerning?"auto":0);r.firstChild.data=t.text;}});g.TextPath.nodeType="text";_4.declare("dojox.gfx.Surface",gs.Surface,{constructor:function(){_7.Container._init.call(this);},destroy:function(){this.defNode=null;this.inherited(arguments);},setDimensions:function(_30,_31){if(!this.rawNode){return this;}this.rawNode.setAttribute("width",_30);this.rawNode.setAttribute("height",_31);return this;},getDimensions:function(){var t=this.rawNode?{width:g.normalizedLength(this.rawNode.getAttribute("width")),height:g.normalizedLength(this.rawNode.getAttribute("height"))}:null;return t;}});g.createSurface=function(_32,_33,_34){var s=new g.Surface();s.rawNode=_8(_7.xmlns.svg,"svg");if(_33){s.rawNode.setAttribute("width",_33);}if(_34){s.rawNode.setAttribute("height",_34);}var _35=_8(_7.xmlns.svg,"defs");s.rawNode.appendChild(_35);s.defNode=_35;s._parent=d.byId(_32);s._parent.appendChild(s.rawNode);return s;};_7.Font={_setFont:function(){var f=this.fontStyle;this.rawNode.setAttribute("font-style",f.style);this.rawNode.setAttribute("font-variant",f.variant);this.rawNode.setAttribute("font-weight",f.weight);this.rawNode.setAttribute("font-size",f.size);this.rawNode.setAttribute("font-family",f.family);}};_7.Container={_init:function(){gs.Container._init.call(this);},openBatch:function(){this.fragment=_c();},closeBatch:function(){if(this.fragment){this.rawNode.appendChild(this.fragment);delete this.fragment;}},add:function(_36){if(this!=_36.getParent()){if(this.fragment){this.fragment.appendChild(_36.rawNode);}else{this.rawNode.appendChild(_36.rawNode);}gs.Container.add.apply(this,arguments);}return this;},remove:function(_37,_38){if(this==_37.getParent()){if(this.rawNode==_37.rawNode.parentNode){this.rawNode.removeChild(_37.rawNode);}if(this.fragment&&this.fragment==_37.rawNode.parentNode){this.fragment.removeChild(_37.rawNode);}gs.Container.remove.apply(this,arguments);}return this;},clear:function(){var r=this.rawNode;while(r.lastChild){r.removeChild(r.lastChild);}var _39=this.defNode;if(_39){while(_39.lastChild){_39.removeChild(_39.lastChild);}r.appendChild(_39);}return gs.Container.clear.apply(this,arguments);},_moveChildToFront:gs.Container._moveChildToFront,_moveChildToBack:gs.Container._moveChildToBack};d.mixin(gs.Creator,{createObject:function(_3a,_3b){if(!this.rawNode){return null;}var _3c=new _3a(),_3d=_8(_7.xmlns.svg,_3a.nodeType);_3c.setRawNode(_3d);_3c.setShape(_3b);this.add(_3c);return _3c;}});d.extend(g.Text,_7.Font);d.extend(g.TextPath,_7.Font);d.extend(g.Group,_7.Container);d.extend(g.Group,gs.Creator);d.extend(g.Surface,_7.Container);d.extend(g.Surface,gs.Creator);if(_7.useSvgWeb){g.createSurface=function(_3e,_3f,_40){var s=new g.Surface();if(!_3f||!_40){var pos=d.position(_3e);_3f=_3f||pos.w;_40=_40||pos.h;}_3e=d.byId(_3e);var id=_3e.id?_3e.id+"_svgweb":g._base._getUniqueId();var _41=_8(_7.xmlns.svg,"svg");_41.id=id;_41.setAttribute("width",_3f);_41.setAttribute("height",_40);svgweb.appendChild(_41,_3e);_41.addEventListener("SVGLoad",function(){s.rawNode=this;s.isLoaded=true;var _42=_8(_7.xmlns.svg,"defs");s.rawNode.appendChild(_42);s.defNode=_42;if(s.onLoad){s.onLoad(s);}},false);s.isLoaded=false;return s;};_4.extend(_6.gfx.shape.Surface,{destroy:function(){var _43=this.rawNode;svgweb.removeChild(_43,_43.parentNode);}});gs._eventsProcessing.connect=function(_44,_45,_46){if(_44.substring(0,2)==="on"){_44=_44.substring(2);}if(arguments.length==2){_46=_45;}else{_46=d.hitch(_45,_46);}this.getEventSource().addEventListener(_44,_46,false);return [this,_44,_46];};gs._eventsProcessing.disconnect=function(_47){this.getEventSource().removeEventListener(_47[1],_47[2],false);delete _47[0];};_4.extend(_6.gfx.Shape,_6.gfx.shape._eventsProcessing);_4.extend(_6.gfx.shape.Surface,_6.gfx.shape._eventsProcessing);}})();}}};});